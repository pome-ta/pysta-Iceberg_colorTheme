"""
note: [Copy Theme(URL)] の検証
"""

import base64
import urllib.parse
import zlib

url = 'pythonista3://?action=add-theme&theme-data=eNqtVkuPmzoU3s-viJhtaTBhEjK7SSaLSvduqq6qSMiYQ-ICdmSb3qZV_3uN7YRHYB66XXJenO87D59fd7OZl-BaHblIGK7Amz3OPMIJP3HmfWi0ijJlpNvlNn5GVljSVGBxTq7K5WYVxGurzCDHdakSBT9uPZOSEmASkoKyzGj__fRl9o8Vuj8e6yplmJZJykUGwlgFOxSgB2twqJUCkaSYFAfBaxcH7UK0CK3FULVEcYguqlvPjjrDokgKOKccC6NVogajyTlTvqQ_DUcoMLIrZZ8IpCAODqOAE5dUcc1QLUpjcFTqJB_38_38QDXA9CPh1X7umN7Pv0vCM_CpDeOrI1SODQknLLCOpZlj9mdhFK6jwKpBCK26Un0P4SpexY5InA6hdmk0gHJc0fJsCwGs5P5nONQlFv06v0BYktMS2t5xCDS8kguL4-M3eWmm5FTLI2QJttmGQbjwA-Sj1RcUPkbrx4fVVwcra-hLMFGUM5lQwlnbbPckyxAsHT-aQZCN_Jf-bCrIiVSCskMrmzU9rfMx3k_BerFdGWejsXVV59IBUFi3qGe0v62RR45AipT_8DNuS9CGdZpup7gsrGUj7McqsZQTqd2TJYkzNP7zF__b99Ct1LNuy-d3frZMrzPr3AQD4Quc0dpkGPai6qH4j9uZGEk9jp6C7bKf-RF0KHbw0RRcCHHkmnWsFCkvM--WPL1fJgJ2Fs3b4jUS31W8G3LE0R9rDJAEn97CdRzhgAzoybmosFLTnXqp0E3Kr-U6XobFXyvD64yNkaX3V9HzabaWn4HuO9yMuXHUvIEwm67nW-m1bF-Clmg9j_aBGCH6w4iVOttSRX3laL0QmMekl8NJ8G9A1PvIV_jwKmbGh3CZfgEHcG8WWL-XakYu8UZcduFTU-FBZrIYWWgdKtdpTMKWyrHUm01bAK9VP7az4lMQNtFmF4fjbRr-tTa9kDK9MBwv71gYNS31xL5Ct9tDN0s5LTkpdHws1BRIrItLVkPXqgI25dI5vd46iRXP6nKq7vF6E28HtXnxQR1zcDfgW_i5c16mvxIJJRhq2-d--_yMdsv2pFFUOWzdq3NwMZz0XfX99ki8DLa7bpi-XK6j5kVRtFn1zpr_cb3t57ra6X5eYaotjEju5y-fR2NXzxBAiBfoIe4fwuNnsuYPhNRsUWxR3Od5EOS5d_f7DyRVKfY~'

# theme-dataを取得
parse_result = urllib.parse.urlparse(url)
query_params = urllib.parse.parse_qs(parse_result.query)
b64string = query_params["theme-data"][0]

# 文字を置換してBase64デコード
b64string = b64string.replace("-", "+")
b64string = b64string.replace("_", "/")
b64string = b64string.replace("~", "=")
compressed_data = base64.b64decode(b64string)

# zlibで展開
decompressed_data = zlib.decompress(compressed_data)

print(decompressed_data.decode())

